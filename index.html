<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Editor</title>
  <style type="text/css" media="screen">
    body {
        overflow: hidden;
    }

    #editor {
        margin: 0;
        position: absolute;
        top: 50px;
        bottom: 0;
        left: 0;
        right: 0;
    }
  </style>
</head>
<body>

<pre id="editor">
</pre>

<select id = "lang" onchange="func()">
		<option value="c_cpp" selected="selected">C++ (g++ 4.8.1)</option>
		<option value="c_cpp">C (gcc 4.8.1)</option>
		<option value="java">Java</option>
    	<option value="javascript">JavaScript</option>
</select>

<button id="compilebutton">Compile</button>
<button>Run</button>

<script src="src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    editor.session.setMode("ace/mode/c_cpp");
    editor.setTheme("ace/theme/twilight");
    var l;

    function func(){
        var x = document.getElementById("lang");
        l = x.options[x.selectedIndex].value;
        console.log(l);
        editor.session.setMode("ace/mode/" + l);
        editor.setValue("");
    }

    $("#compilebutton").click(function()
    {
        var URL = "https://api.hackerearth.com/v3/code/run/";
        var CLIENT_SECRET = 'c6ade9190ec7565893ab5d154a4592ba08d1526a';
        var source = editor.getValue();
        data = {
            client_secret: CLIENT_SECRET,
            async: 0,
            source: source,
            lang: "JAVA",
            time_limit: 2,
            memory_limit: 262144,
        }
        $.post(URL,data);
    });
    /*
    function compile_code() {
        //var compile_URL = "https://api.hackerearth.com/v3/code/compile/";
        var URL = "https://api.hackerearth.com/v3/code/run/";
        var CLIENT_SECRET = 'c6ade9190ec7565893ab5d154a4592ba08d1526a';
        var source = editor.getValue();
        console.log(l);
        console.log(source);
        var http = new XMLHttpRequest();
        var hearth_lang;
        if (l=='c_cpp')
        {
            hearth_lang = 'CPP';
        }
        else if (l == 'java')
        {
            hearth_lang = 'JAVA';
        }
        console.log(l);
        console.log(hearth_lang);

        var params = "client_secret="+CLIENT_SECRET+"&async=0&source=" + source + "&lang="+ hearth_lang +"&time_limit = 2&memory_limit=262144";
        http.open("POST", URL, true);

        //Send the proper header information along with the request
        http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

        http.onreadystatechange = function() {//Call a function when the state changes.
            if(http.readyState == 4 && http.status == 200) {
                alert(http.responseText);
            }
        }
        http.send(params);
    }
*/
</script>

</body>
</html>
